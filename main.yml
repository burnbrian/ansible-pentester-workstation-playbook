---
- name: Pentester Workstation Playbook (PWP)
  hosts: all

  vars_files:
  - config.yml

  pre_tasks:
  # update and upgrade system with full-upgrade
  - name: pre-run | update and full-upgrade
    ansible.builtin.apt:
      cache_valid_time: 86400
      upgrade: full
    become: true
    become_method: sudo
    when: ansible_distribution in ["Ubuntu"]

  # install configs for galaxy roles
  - name: pre-run | install ansible galaxy role configs
    include_vars: "{{ item }}"
    with_items:
      - requirements.yml

  # run external ansible galaxy roles
  roles:
    - role: iesplin.burp_suite
      tags: ['burpsuite']
    - role: gantsign.visual-studio-code
      tags: ['vscode']

  # run tasks from tasks directory
  tasks:
  - import_tasks: tasks/disable-services.yml
  - import_tasks: tasks/apts.yml
  - import_tasks: tasks/snaps.yml
  - import_tasks: tasks/pipx.yml
  - import_tasks: tasks/git-repos.yml
  - import_tasks: tasks/dotfiles.yml
    tags: ['dotfiles']
  - import_tasks: tasks/appearance.yml
    tags: ['appearance']
  - import_tasks: tasks/ufw.yml
    tags: ['firewall']